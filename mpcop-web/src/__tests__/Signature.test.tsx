import { verifyRsaCipher } from "../math/cipher";
import { verifyRsaSignature, verifySchnorrSignature } from "../math/signature";

describe("Signature verification", () => {
	describe("verifySchnorrSignature() function", () => {
		const plaintext =
			"5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8";
		const validSignature =
			"ec39843770ac3ecd24a41b7bbb14c65953dd1a182b723073ee74e024bc42d9c9;5A093F2B2CB8E9DD6202E8B178E0ACA5AA4E6DF4EFB9DEA62CAB5DDC12E53DC6";
		const invalidSignature =
			"5fcd7814cddfbadf55f934e6e7fa5d12dd2b8418de8bb20705969d5e1b9baab0;0DD33307E556E1B8C6C09797830B2F985665666EB9C7D89662C2A2D393DD3B64";
		const pubkey =
			"041B39D97AF794C27BC0543A29EAED4F88AE08BBC8AD0A374DCC81B95893805D9D7CFFD53213FABBAEDB28CA569789B9C8CB4E8B6FA549A8945C791D1AC837475D";

		it("Should detect a valid signature", () => {
			expect(
				verifySchnorrSignature(validSignature, plaintext, pubkey)
			).toBeTruthy();
		});

		it("Should detect an invalid signature", () => {
			expect(
				verifySchnorrSignature(invalidSignature, plaintext, pubkey)
			).toBeFalsy();
		});
	});

	describe("verifyRsaSignature() function", () => {
		const plaintext =
			"5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8";
		const validSignature =
			"aa313246f500a1c41ed4f1ce295dcdd5bcc1c4c6c193febb5cb2e4b90be45d58581f4fe89fec2c6c04a73edf5c43b6b4c159f4e4f8f7fd1962f36bd5d5482d1b1f90490a3b2d8fcce4ca59a96835c8df4bc938e9efa78d67f65fe72a02e45977753d14e9297632ccdd434bd812d1d2d565558f4a769a778a74e1fab6a3454e8d345a3946d9ff76dcdfb71a050c37b97d4cdd38b86e64004bf771b6924ff93d8767384907bb57b5d3f999010ad8088e54e9251ed1ac2c67d57bc6e3f15972a536d4b057eff0ed56b5583fe20d5a293a7064a51df6c085720dc51e13aa89b1607f9864c0291095356d8212ff8a72d791b4560337ab72a1836ad06abc48dd16b958c8b4b7b21445ec89f811a0e76741cb6c06d9e9ea3fee72569c5a2eb326440b075199308c6a51802e7fd0e3e552b5d615b96a71e0d7a6a351c31a9dc54a12e3a2ac2ae09e182226506b15f4eebf68af5a64697a92cbbf142d99d4a45a5f5b865cadf11ae928e987f03eb048af86ca71ee533636bf1dfea5585ef946b12873398de461121a82579ae285a2771ba97911dc997f4ab8b7f54c7e78ed4d3471884d51060dafd89452a9b5a62efa9b42d154252d92f86758e4faa935ee90280f07d48e4cc84246049b73814fbf9be72d91ea2e440e176c038800c1fa76b5bdd686645eabe20cef572928347edb613f45fd5a2b3c776875a648fd3c0e646e83b3038f9e";
		const invalidSignature =
			"ba313246f500a1c41ed4f1ce295dcdd5bcc1c4c6c193febb5cb2e4b90be45d58581f4fe89fec2c6c04a73edf5c43b6b4c159f4e4f8f7fd1962f36bd5d5482d1b1f90490a3b2d8fcce4ca59a96835c8df4bc938e9efa78d67f65fe72a02e45977753d14e9297632ccdd434bd812d1d2d565558f4a769a778a74e1fab6a3454e8d345a3946d9ff76dcdfb71a050c37b97d4cdd38b86e64004bf771b6924ff93d8767384907bb57b5d3f999010ad8088e54e9251ed1ac2c67d57bc6e3f15972a536d4b057eff0ed56b5583fe20d5a293a7064a51df6c085720dc51e13aa89b1607f9864c0291095356d8212ff8a72d791b4560337ab72a1836ad06abc48dd16b958c8b4b7b21445ec89f811a0e76741cb6c06d9e9ea3fee72569c5a2eb326440b075199308c6a51802e7fd0e3e552b5d615b96a71e0d7a6a351c31a9dc54a12e3a2ac2ae09e182226506b15f4eebf68af5a64697a92cbbf142d99d4a45a5f5b865cadf11ae928e987f03eb048af86ca71ee533636bf1dfea5585ef946b12873398de461121a82579ae285a2771ba97911dc997f4ab8b7f54c7e78ed4d3471884d51060dafd89452a9b5a62efa9b42d154252d92f86758e4faa935ee90280f07d48e4cc84246049b73814fbf9be72d91ea2e440e176c038800c1fa76b5bdd686645eabe20cef572928347edb613f45fd5a2b3c776875a648fd3c0e646e83b3038f9e";
		const pubkey =
			"00bd6267b2e260b8ffb52908d900accc11efecdde1cba089b6c73e135d79f0ddcd8693be67f820f5fc6901a5a7a7efec07984289b49d030da7329e7b0bff53a10a4ef99006443f2e944ea9a3baf7999a8b8f11ecb1c14c5d4906e86a67188d3db12a646cb5500b559355bfc2ad04171e556ecb7642c927a2d5976dd68df258236526ee882d081f0743094c5806246cfe3b735be13e82ad48d7a5c6761421fb6216738e3ef43db4452e6ab7294fe78dc081865bb39c6e726975593d98ec332b27c959b6ee1f96f3143d686148c1467c0dd983b138ec4ef0003503e843ba8ea39c41b7e03acbece83c5e89740821a2a61740f23997007fc713fe493aca7e576b1508c6c3aeb88d6c3ad203d9b4cfa207a1b6370a975a9abd90714946e8716a49eecd0c992ddbbab8042365ff39e0e8146857d88fd4668d7454b9d034e5ff4c94c86a79d380587d874c9a0f1d629b25112a21c391d7c21b56b82f76b10384927087394b56559cdad3fa8800241db86a9e5ccaafe05b884cac332e23838ae1cd68069e89484a730801744ffa8dbae0b807ba8eb52b8e986a904e7b6075341d28c99dbd6688dbbe78a31e04fb3b5009257cd8c948aa0e1d56df66507d27f25f5e4e89b61b8163b2809ac0690bd294594612ae258f9c4a34bea0ef3fb8a005617a27952d165d90160632470ba20eec29e4401967198da21afc8ee92c73269ef1ce5567d5";
			
		it("should detect a valid signature", () => {
			expect(
				verifyRsaSignature(validSignature, plaintext, pubkey)
			).toBeTruthy();
		});

		it("should detect an invalid signature", () => {
			expect(
				verifyRsaSignature(invalidSignature, plaintext, pubkey)
			).toBeFalsy();
		});
	});
});
